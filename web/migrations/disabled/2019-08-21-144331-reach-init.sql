CREATE TABLE users_group (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(255) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE shop (id INT AUTO_INCREMENT NOT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, name VARCHAR(255) NOT NULL, open_time TIME NOT NULL, close_time TIME NOT NULL, open_day_of_week SMALLINT NOT NULL, close_day_of_week SMALLINT NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_AC6A4CA2B03A8386 (created_by_id), INDEX IDX_AC6A4CA2896DBBDE (updated_by_id), INDEX IDX_AC6A4CA2C76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE metric (id INT AUTO_INCREMENT NOT NULL, shop_id INT DEFAULT NULL, target_group_id INT DEFAULT NULL, metric_param_id INT DEFAULT NULL, block_time TIME NOT NULL, block_day_of_week SMALLINT NOT NULL, value VARCHAR(255) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_87D62EE34D16C4DD (shop_id), INDEX IDX_87D62EE324FF092E (target_group_id), INDEX IDX_87D62EE35C665256 (metric_param_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE target_group_param (id INT AUTO_INCREMENT NOT NULL, users_group_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, name VARCHAR(128) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_73EC18E48515F29D (users_group_id), INDEX IDX_73EC18E4B03A8386 (created_by_id), INDEX IDX_73EC18E4896DBBDE (updated_by_id), INDEX IDX_73EC18E4C76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE target_group_value (id INT AUTO_INCREMENT NOT NULL, param_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, name VARCHAR(128) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_CA613C595647C863 (param_id), INDEX IDX_CA613C59B03A8386 (created_by_id), INDEX IDX_CA613C59896DBBDE (updated_by_id), INDEX IDX_CA613C59C76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE target_group (id INT AUTO_INCREMENT NOT NULL, users_group_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, name VARCHAR(128) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_D16BDFC98515F29D (users_group_id), INDEX IDX_D16BDFC9B03A8386 (created_by_id), INDEX IDX_D16BDFC9896DBBDE (updated_by_id), INDEX IDX_D16BDFC9C76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE targets_param_values (target_group_entity_id INT NOT NULL, target_group_param_value_entity_id INT NOT NULL, INDEX IDX_C331B7BD398C3DF (target_group_entity_id), INDEX IDX_C331B7BDA16F0197 (target_group_param_value_entity_id), PRIMARY KEY(target_group_entity_id, target_group_param_value_entity_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE metric_param (id INT AUTO_INCREMENT NOT NULL, users_group_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, name VARCHAR(128) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_27A6831C8515F29D (users_group_id), INDEX IDX_27A6831CB03A8386 (created_by_id), INDEX IDX_27A6831C896DBBDE (updated_by_id), INDEX IDX_27A6831CC76F1F52 (deleted_by_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE shop ADD CONSTRAINT FK_AC6A4CA2B03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE shop ADD CONSTRAINT FK_AC6A4CA2896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE shop ADD CONSTRAINT FK_AC6A4CA2C76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE metric ADD CONSTRAINT FK_87D62EE34D16C4DD FOREIGN KEY (shop_id) REFERENCES shop (id) ON DELETE CASCADE;
ALTER TABLE metric ADD CONSTRAINT FK_87D62EE324FF092E FOREIGN KEY (target_group_id) REFERENCES target_group (id) ON DELETE CASCADE;
ALTER TABLE metric ADD CONSTRAINT FK_87D62EE35C665256 FOREIGN KEY (metric_param_id) REFERENCES metric_param (id) ON DELETE CASCADE;
ALTER TABLE target_group_param ADD CONSTRAINT FK_73EC18E48515F29D FOREIGN KEY (users_group_id) REFERENCES users_group (id) ON DELETE CASCADE;
ALTER TABLE target_group_param ADD CONSTRAINT FK_73EC18E4B03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE target_group_param ADD CONSTRAINT FK_73EC18E4896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE target_group_param ADD CONSTRAINT FK_73EC18E4C76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE target_group_value ADD CONSTRAINT FK_CA613C595647C863 FOREIGN KEY (param_id) REFERENCES target_group_param (id) ON DELETE CASCADE;
ALTER TABLE target_group_value ADD CONSTRAINT FK_CA613C59B03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE target_group_value ADD CONSTRAINT FK_CA613C59896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE target_group_value ADD CONSTRAINT FK_CA613C59C76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE target_group ADD CONSTRAINT FK_D16BDFC98515F29D FOREIGN KEY (users_group_id) REFERENCES users_group (id) ON DELETE CASCADE;
ALTER TABLE target_group ADD CONSTRAINT FK_D16BDFC9B03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE target_group ADD CONSTRAINT FK_D16BDFC9896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE target_group ADD CONSTRAINT FK_D16BDFC9C76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE targets_param_values ADD CONSTRAINT FK_C331B7BD398C3DF FOREIGN KEY (target_group_entity_id) REFERENCES target_group (id) ON DELETE CASCADE;
ALTER TABLE targets_param_values ADD CONSTRAINT FK_C331B7BDA16F0197 FOREIGN KEY (target_group_param_value_entity_id) REFERENCES target_group_value (id) ON DELETE CASCADE;
ALTER TABLE metric_param ADD CONSTRAINT FK_27A6831C8515F29D FOREIGN KEY (users_group_id) REFERENCES users_group (id) ON DELETE CASCADE;
ALTER TABLE metric_param ADD CONSTRAINT FK_27A6831CB03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE metric_param ADD CONSTRAINT FK_27A6831C896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE metric_param ADD CONSTRAINT FK_27A6831CC76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE users ADD group_id INT DEFAULT NULL, CHANGE updated_by_id updated_by_id INT DEFAULT NULL, CHANGE created_by_id created_by_id INT DEFAULT NULL, CHANGE deleted_by_id deleted_by_id INT DEFAULT NULL, CHANGE new_password new_password VARCHAR(32) DEFAULT NULL, CHANGE inserted inserted DATETIME DEFAULT NULL, CHANGE updated updated DATETIME DEFAULT NULL;
ALTER TABLE users ADD CONSTRAINT FK_1483A5E9FE54D947 FOREIGN KEY (group_id) REFERENCES users_group (id);
CREATE INDEX IDX_1483A5E9FE54D947 ON users (group_id);
